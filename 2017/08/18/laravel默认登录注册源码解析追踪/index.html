<!DOCTYPE html>
<html style="display: none;" lang="zh">
    <head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <!--
        © Material Theme
        https://github.com/viosey/hexo-theme-material
        Version: 1.5.6 -->
    <script>
        window.materialVersion = "1.5.6"
        // Delete localstorage with these tags
        window.oldVersion = [
            'codestartv1',
            '1.3.4',
            '1.4.0',
            '1.4.0b1',
            '1.5.0',
            '1.5.2',
            '1.5.5'
        ]
    </script>

    <!-- dns prefetch -->
    <meta http-equiv="x-dns-prefetch-control" content="on">









    <link rel="dns-prefetch" href="https://fonts.googleapis.com">





    <!-- Meta & Info -->
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
    <meta name="renderer" content="webkit">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!-- Title -->
    
    <title>
        
            laravel默认登录注册源码解析追踪 | 
        
        chemf
    </title>

    <!-- Favicons -->
    <link rel="icon shortcut" type="image/ico" href="/img/fuza.png">
    <link rel="icon" href="/img/fuza.png">

    <meta name="format-detection" content="telephone=no">
    <meta name="description" itemprop="description" content="  被laravel的登录注册烦恼了好一段时间，总算理顺了思路。">
    <meta name="keywords" content="null,php,laravel">
    <meta name="theme-color" content="#0097A7">

    <!-- Disable Fucking Bloody Baidu Tranformation -->
    <meta http-equiv="Cache-Control" content="no-transform">
    <meta http-equiv="Cache-Control" content="no-siteapp">

    <!--[if lte IE 9]>
        <link rel="stylesheet" href="/css/ie-blocker.css">

        
            <script src="/js/ie-blocker.zhCN.js"></script>
        
    <![endif]-->

    <!-- Import lsloader -->
    <script>(function(){window.lsloader={jsRunSequence:[],jsnamemap:{},cssnamemap:{}};lsloader.removeLS=function(a){try{localStorage.removeItem(a)}catch(b){}};lsloader.setLS=function(a,c){try{localStorage.setItem(a,c)}catch(b){}};lsloader.getLS=function(a){var c="";try{c=localStorage.getItem(a)}catch(b){c=""}return c};versionString="/*"+(window.materialVersion||"unknownVersion")+"*/";lsloader.clean=function(){try{var b=[];for(var a=0;a<localStorage.length;a++){b.push(localStorage.key(a))}b.forEach(function(e){var f=lsloader.getLS(e);if(window.oldVersion){var d=window.oldVersion.reduce(function(g,h){return g||f.indexOf("/*"+h+"*/")!==-1},false);if(d){lsloader.removeLS(e)}}})}catch(c){}};lsloader.clean();lsloader.load=function(f,a,b,d){if(typeof b==="boolean"){d=b;b=undefined}d=d||false;b=b||function(){};var e;e=this.getLS(f);if(e&&e.indexOf(versionString)===-1){this.removeLS(f);this.requestResource(f,a,b,d);return}if(e){var c=e.split(versionString)[0];if(c!=a){console.log("reload:"+a);this.removeLS(f);this.requestResource(f,a,b,d);return}e=e.split(versionString)[1];if(d){this.jsRunSequence.push({name:f,code:e});this.runjs(a,f,e)}else{document.getElementById(f).appendChild(document.createTextNode(e));b()}}else{this.requestResource(f,a,b,d)}};lsloader.requestResource=function(b,e,a,c){var d=this;if(c){this.iojs(e,b,function(h,f,g){d.setLS(f,h+versionString+g);d.runjs(h,f,g)})}else{this.iocss(e,b,function(f){document.getElementById(b).appendChild(document.createTextNode(f));d.setLS(b,e+versionString+f)},a)}};lsloader.iojs=function(d,b,g){var a=this;a.jsRunSequence.push({name:b,code:""});try{var f=new XMLHttpRequest();f.open("get",d,true);f.onreadystatechange=function(){if(f.readyState==4){if((f.status>=200&&f.status<300)||f.status==304){if(f.response!=""){g(d,b,f.response);return}}a.jsfallback(d,b)}};f.send(null)}catch(c){a.jsfallback(d,b)}};lsloader.iocss=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.iofonts=function(f,c,h,a){var b=this;try{var g=new XMLHttpRequest();g.open("get",f,true);g.onreadystatechange=function(){if(g.readyState==4){if((g.status>=200&&g.status<300)||g.status==304){if(g.response!=""){h(g.response);a();return}}b.cssfallback(f,c,a)}};g.send(null)}catch(d){b.cssfallback(f,c,a)}};lsloader.runjs=function(f,c,e){if(!!c&&!!e){for(var b in this.jsRunSequence){if(this.jsRunSequence[b].name==c){this.jsRunSequence[b].code=e}}}if(!!this.jsRunSequence[0]&&!!this.jsRunSequence[0].code&&this.jsRunSequence[0].status!="failed"){var a=document.createElement("script");a.appendChild(document.createTextNode(this.jsRunSequence[0].code));a.type="text/javascript";document.getElementsByTagName("head")[0].appendChild(a);this.jsRunSequence.shift();if(this.jsRunSequence.length>0){this.runjs()}}else{if(!!this.jsRunSequence[0]&&this.jsRunSequence[0].status=="failed"){var d=this;var a=document.createElement("script");a.src=this.jsRunSequence[0].path;a.type="text/javascript";this.jsRunSequence[0].status="loading";a.onload=function(){d.jsRunSequence.shift();if(d.jsRunSequence.length>0){d.runjs()}};document.body.appendChild(a)}}};lsloader.tagLoad=function(b,a){this.jsRunSequence.push({name:a,code:"",path:b,status:"failed"});this.runjs()};lsloader.jsfallback=function(c,b){if(!!this.jsnamemap[b]){return}else{this.jsnamemap[b]=b}for(var a in this.jsRunSequence){if(this.jsRunSequence[a].name==b){this.jsRunSequence[a].code="";this.jsRunSequence[a].status="failed";this.jsRunSequence[a].path=c}}this.runjs()};lsloader.cssfallback=function(e,c,b){if(!!this.cssnamemap[c]){return}else{this.cssnamemap[c]=1}var d=document.createElement("link");d.type="text/css";d.href=e;d.rel="stylesheet";d.onload=d.onerror=b;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(d,a)};lsloader.runInlineScript=function(c,b){var a=document.getElementById(b).innerText;this.jsRunSequence.push({name:c,code:a});this.runjs()}})();</script>

    <!-- Import queue -->
    <script>function Queue(){this.dataStore=[];this.offer=b;this.poll=d;this.execNext=a;this.debug=false;this.startDebug=c;function b(e){if(this.debug){console.log("Offered a Queued Function.")}if(typeof e==="function"){this.dataStore.push(e)}else{console.log("You must offer a function.")}}function d(){if(this.debug){console.log("Polled a Queued Function.")}return this.dataStore.shift()}function a(){var e=this.poll();if(e!==undefined){if(this.debug){console.log("Run a Queued Function.")}e()}}function c(){this.debug=true}}var queue=new Queue();</script>

    <!-- Import CSS -->
    
        <style id="material_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_css","/css/material.min.css?Z7a72R1E4SxzBKR/WGctOA==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>
        <style id="style_css"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("style_css","/css/style.min.css?NKhlKQkXw/c66TR5p4wO+w==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>

        

    

    

    <!-- Config CSS -->

<!-- Other Styles -->
<style>
  body, html {
    font-family: Roboto, "Helvetica Neue", Helvetica, "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "微软雅黑", Arial, sans-serif;
    overflow-x: hidden !important;
  }
  
  code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  a {
    color: #00838F;
  }

  .mdl-card__media,
  #search-label,
  #search-form-label:after,
  #scheme-Paradox .hot_tags-count,
  #scheme-Paradox .sidebar_archives-count,
  #scheme-Paradox .sidebar-colored .sidebar-header,
  #scheme-Paradox .sidebar-colored .sidebar-badge{
    background-color: #0097A7 !important;
  }

  /* Sidebar User Drop Down Menu Text Color */
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:hover,
  #scheme-Paradox .sidebar-colored .sidebar-nav>.dropdown>.dropdown-menu>li>a:focus {
    color: #0097A7 !important;
  }

  #post_entry-right-info,
  .sidebar-colored .sidebar-nav li:hover > a,
  .sidebar-colored .sidebar-nav li:hover > a i,
  .sidebar-colored .sidebar-nav li > a:hover,
  .sidebar-colored .sidebar-nav li > a:hover i,
  .sidebar-colored .sidebar-nav li > a:focus i,
  .sidebar-colored .sidebar-nav > .open > a,
  .sidebar-colored .sidebar-nav > .open > a:hover,
  .sidebar-colored .sidebar-nav > .open > a:focus,
  #ds-reset #ds-ctx .ds-ctx-entry .ds-ctx-head a {
    color: #0097A7 !important;
  }

  .toTop {
    background: #757575 !important;
  }

  .material-layout .material-post>.material-nav,
  .material-layout .material-index>.material-nav,
  .material-nav a {
    color: #757575;
  }

  #scheme-Paradox .MD-burger-layer {
    background-color: #757575;
  }

  #scheme-Paradox #post-toc-trigger-btn {
    color: #757575;
  }

  .post-toc a:hover {
    color: #00838F;
    text-decoration: underline;
  }

</style>


<!-- Theme Background Related-->

    <style>
      body{
        background-color: #F5F5F5;
      }

      /* blog_info bottom background */
      #scheme-Paradox .material-layout .something-else .mdl-card__supporting-text{
        background-color: #fff;
      }
    </style>




<!-- Fade Effect -->

    <style>
      .fade {
        transition: all 800ms linear;
        -webkit-transform: translate3d(0,0,0);
        -moz-transform: translate3d(0,0,0);
        -ms-transform: translate3d(0,0,0);
        -o-transform: translate3d(0,0,0);
        transform: translate3d(0,0,0);
        opacity: 1;
      }

      .fade.out{
        opacity: 0;
      }
    </style>


<!-- Import Font -->
<!-- Import Roboto -->

    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet">


<!-- Import Material Icons -->


    <style id="material_icons"></style><script>if(typeof window.lsLoadCSSMaxNums === "undefined")window.lsLoadCSSMaxNums = 0;window.lsLoadCSSMaxNums++;lsloader.load("material_icons","/css/material-icons.css?pqhB/Rd/ab0H2+kZp0RDmw==",function(){if(typeof window.lsLoadCSSNums === "undefined")window.lsLoadCSSNums = 0;window.lsLoadCSSNums++;if(window.lsLoadCSSNums == window.lsLoadCSSMaxNums)document.documentElement.style.display="";}, false)</script>




    <!-- Import jQuery -->
    
        <script>lsloader.load("jq_js","/js/jquery.min.js?qcusAULNeBksqffqUM2+Ig==", true)</script>
    

    <!-- WebAPP Icons -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="application-name" content="chemf">
    <meta name="msapplication-starturl" content="http://eoyohe.cn/2017/08/18/laravel默认登录注册源码解析追踪/">
    <meta name="msapplication-navbutton-color" content="#0097A7">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="chemf">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon" href="/img/fuza.png">

    <!-- Site Verification -->
    
    

    <!-- RSS -->
    

    <!-- The Open Graph protocol -->
    <meta property="og:url" content="http://eoyohe.cn/2017/08/18/laravel默认登录注册源码解析追踪/">
    <meta property="og:type" content="blog">
    <meta property="og:title" content="laravel默认登录注册源码解析追踪 | chemf">
    <meta property="og:image" content="/img/fuza.png">
    <meta property="og:description" content="  被laravel的登录注册烦恼了好一段时间，总算理顺了思路。">
    <meta property="og:article:tag" content="php"> <meta property="og:article:tag" content="laravel"> 

    
        <meta property="article:published_time" content="Fri Aug 18 2017 16:26:58 GMT+0800">
        <meta property="article:modified_time" content="Sat Oct 22 2022 22:11:25 GMT+0800">
    

    <!-- The Twitter Card protocol -->
    <meta name="twitter:card" content="summary_large_image">

    <!-- Add canonical link for SEO -->
    
        <link rel="canonical" href="http://eoyohe.cn/2017/08/18/laravel默认登录注册源码解析追踪/index.html">
    

    <!-- Structured-data for SEO -->
    
        


<script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "mainEntityOfPage": "http://eoyohe.cn/2017/08/18/laravel默认登录注册源码解析追踪/index.html",
    "headline": "laravel默认登录注册源码解析追踪",
    "datePublished": "Fri Aug 18 2017 16:26:58 GMT+0800",
    "dateModified": "Sat Oct 22 2022 22:11:25 GMT+0800",
    "author": {
        "@type": "Person",
        "name": "呃哦",
        "image": {
            "@type": "ImageObject",
            "url": "/img/favicon.png"
        },
        "description": "Hi, nice to meet you"
    },
    "publisher": {
        "@type": "Organization",
        "name": "chemf",
        "logo": {
            "@type":"ImageObject",
            "url": "/img/fuza.png"
        }
    },
    "keywords": ",php,laravelnull",
    "description": "  被laravel的登录注册烦恼了好一段时间，总算理顺了思路。",
}
</script>


    

    <!-- Analytics -->
    
    
    

    <!-- Custom Head -->
    

</head>


    
        <body id="scheme-Paradox" class="lazy">
            <div class="material-layout  mdl-js-layout has-drawer is-upgraded">
                

                <!-- Main Container -->
                <main class="material-layout__content" id="main">

                    <!-- Top Anchor -->
                    <div id="top"></div>

                    
                        <!-- Hamburger Button -->
                        <button class="MD-burger-icon sidebar-toggle">
                            <span id="MD-burger-id" class="MD-burger-layer"></span>
                        </button>
                    

                    <!-- Post TOC -->

    
    <!-- Back Button -->
    <!--
    <div class="material-back" id="backhome-div" tabindex="0">
        <a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon"
           href="#" onclick="window.history.back();return false;"
           target="_self"
           role="button"
           data-upgraded=",MaterialButton,MaterialRipple">
            <i class="material-icons" role="presentation">arrow_back</i>
            <span class="mdl-button__ripple-container">
                <span class="mdl-ripple"></span>
            </span>
        </a>
    </div>
    -->


    <!-- Left aligned menu below button -->
    
    
    <button id="post-toc-trigger-btn"
        class="mdl-button mdl-js-button mdl-button--icon">
        <i class="material-icons">format_list_numbered</i>
    </button>

    <ul class="post-toc-wrap mdl-menu mdl-menu--bottom-left mdl-js-menu mdl-js-ripple-effect" for="post-toc-trigger-btn" style="max-height:80vh; overflow-y:scroll;">
        <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#Auth"><span class="post-toc-number">1.</span> <span class="post-toc-text">Auth</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#guard"><span class="post-toc-number">2.</span> <span class="post-toc-text">guard</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#providers"><span class="post-toc-number">3.</span> <span class="post-toc-text">providers</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#自定义Model。"><span class="post-toc-number">4.</span> <span class="post-toc-text">自定义Model。</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#登录认证过程"><span class="post-toc-number"></span> <span class="post-toc-text">登录认证过程</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#注册认证过程"><span class="post-toc-number"></span> <span class="post-toc-text">注册认证过程</span></a>
    </ul>
    




<!-- Layouts -->

    <!-- Post Module -->
    <div class="material-post_container">

        <div class="material-post mdl-grid">
            <div class="mdl-card mdl-shadow--4dp mdl-cell mdl-cell--12-col">

                <!-- Post Header(Thumbnail & Title) -->
                
    <!-- Paradox Post Header -->
    
        
            <!-- Random Thumbnail -->
            <div class="post_thumbnail-random mdl-card__media mdl-color-text--grey-50">
            <script type="text/ls-javascript" id="post-thumbnail-script">
    var randomNum = Math.floor(Math.random() * 19 + 1);

    $('.post_thumbnail-random').attr('data-original', '/img/random/material-' + randomNum + '.png');
    $('.post_thumbnail-random').addClass('lazy');
</script>

        
    
            <p class="article-headline-p">
                laravel默认登录注册源码解析追踪
            </p>
        </div>





                
                    <!-- Paradox Post Info -->
                    <div class="mdl-color-text--grey-700 mdl-card__supporting-text meta">

    <!-- Author Avatar -->
    <div id="author-avatar">
        <img src="/img/favicon.png" width="44px" height="44px" alt="Author Avatar"/>
    </div>
    <!-- Author Name & Date -->
    <div>
        <strong>呃哦</strong>
        <span>8月 18, 2017</span>
    </div>

    <div class="section-spacer"></div>

    <!-- Favorite -->
    <!--
        <button id="article-functions-like-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon btn-like">
            <i class="material-icons" role="presentation">favorite</i>
            <span class="visuallyhidden">favorites</span>
        </button>
    -->

    <!-- Qrcode -->
    

    <!-- Tags (bookmark) -->
    
    <button id="article-functions-viewtags-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
        <i class="material-icons" role="presentation">bookmark</i>
        <span class="visuallyhidden">bookmark</span>
    </button>
    <ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-functions-viewtags-button">
        <li class="mdl-menu__item">
        <a class="post_tag-link" href="/tags/laravel/">laravel</a></li><li class="mdl-menu__item"><a class="post_tag-link" href="/tags/php/">php</a>
    </ul>
    

    <!-- Share -->
    
        <button id="article-fuctions-share-button" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon">
    <i class="material-icons" role="presentation">share</i>
    <span class="visuallyhidden">share</span>
</button>
<ul class="mdl-menu mdl-menu--bottom-right mdl-js-menu mdl-js-ripple-effect" for="article-fuctions-share-button">
    

    

    <!-- Share Weibo -->
    
        <a class="post_share-link" href="http://service.weibo.com/share/share.php?appkey=&title=laravel默认登录注册源码解析追踪&url=http://eoyohe.cn/2017/08/18/laravel默认登录注册源码解析追踪/index.html&pic=http://eoyohe.cn/img/fuza.png&searchPic=false&style=simple" target="_blank">
            <li class="mdl-menu__item">
                分享到微博
            </li>
        </a>
    

    <!-- Share Twitter -->
    

    <!-- Share Facebook -->
    

    <!-- Share Google+ -->
    

    <!-- Share LinkedIn -->
    

    <!-- Share QQ -->
    
        <a class="post_share-link" href="http://connect.qq.com/widget/shareqq/index.html?site=chemf&title=laravel默认登录注册源码解析追踪&summary=null&pics=http://eoyohe.cn/img/fuza.png&url=http://eoyohe.cn/2017/08/18/laravel默认登录注册源码解析追踪/index.html" target="_blank">
            <li class="mdl-menu__item">
                分享到 QQ
            </li>
        </a>
    

    <!-- Share Telegram -->
    
</ul>

    
</div>

                

                <!-- Post Content -->
                <div id="post-content" class="mdl-color-text--grey-700 mdl-card__supporting-text fade out">
    
        <p>  被laravel的登录注册烦恼了好一段时间，总算理顺了思路。<br><a id="more"></a><br>laravel内部封装实现好了一个简单版本的登录注册模块，通过以下命令即可快速开启:</p>
<pre><code class="bash">php artisan make:auth
</code></pre>
<p>但是毕竟是默认实现好的，总想知道内部代码实现。于是开始了源码之旅。。。</p>
<h4 id="Auth"><a href="#Auth" class="headerlink" title="Auth"></a>Auth</h4><p>先说说laravel的认证过程，门面(Facade) <strong>Auth</strong> 提供了一些便捷的方法如获得当前认证用户信息等，实际上负责认证用户的是守卫 <strong>guard</strong> ，guard负责该用户是否通过验证，是否已登录，是否 <code>记住</code>等。<strong>门面Auth实际上是在   <code>AuthServiceProvider</code> 中注册的 <code>AuthManager</code> 的实例</strong></p>
<h4 id="guard"><a href="#guard" class="headerlink" title="guard"></a>guard</h4><p>关于<strong>guard</strong>的配置在config/Auth.php中，如配置默认使用哪个 <strong>guard</strong> ， <strong>guard</strong> 使用的驱动，框架默认实现的有 <code>session</code> 和 <code>token</code>  两个驱动类。驱动类则负责从服务提供类中获得认证需要的数据。</p>
<pre><code>    &#39;guards&#39; =&gt; [
        &#39;web&#39; =&gt; [
            &#39;driver&#39; =&gt; &#39;session&#39;,
            &#39;provider&#39; =&gt; &#39;users&#39;,
        ],

        &#39;api&#39; =&gt; [
            &#39;driver&#39; =&gt; &#39;token&#39;,
            &#39;provider&#39; =&gt; &#39;users&#39;,
        ],
    ],

</code></pre><p>自定义guard类，guard需要检查用户是否登录，认证账号是否正确等，因此laravel定义了一个契约接口需要实现，自定义guard需要<code>StatefulGuard</code>或者<code>Guard</code>接口。然后在 <strong>AuthServiceProvider</strong> 中注册guard。</p>
<pre><code class="php">class AuthServiceProvider extends ServiceProvider
{
    /**
     * Register any application authentication / authorization services.
     *
     * @return void
     */
    public function boot()
    {
        $this-&gt;registerPolicies();

        // &#39;jwt&#39;为注册guard的名字，待会在config/auth.php中配置。
        // 匿名函数返回自定义的guard类的实例
        Auth::extend(&#39;jwt&#39;, function ($app, $name, array $config) {
            // Return an instance of Illuminate\Contracts\Auth\Guard...

            return new JwtGuard(Auth::createUserProvider($config[&#39;provider&#39;]));
        });
    }
}
</code></pre>
<p>注册后需要在config/auth.php中配置</p>
<pre><code>&#39;guards&#39; =&gt; [
    &#39;api&#39; =&gt; [
        &#39;driver&#39; =&gt; &#39;jwt&#39;,
        &#39;provider&#39; =&gt; &#39;users&#39;,
    ],
],
</code></pre><h4 id="providers"><a href="#providers" class="headerlink" title="providers"></a>providers</h4><p><strong>guard</strong> 负责认证用户，具体为针对请求中的认证信息，对对应数据库中的信息查询是否存在，而查询信息这种操作便是交给服务提供者来实现了。在默认配置中，设定了 ‘web’ 这个 <strong>guard</strong> 的提供者为 <code>users</code> 。 下面是 <code>users</code> 的配置。</p>
<pre><code>    &#39;providers&#39; =&gt; [
        &#39;users&#39; =&gt; [
            &#39;driver&#39; =&gt; &#39;eloquent&#39;,
            &#39;model&#39; =&gt; App\User::class,
        ],
</code></pre><p><code>users</code>使用 <code>eloquent</code>驱动，默认的驱动支持<code>eloquent</code>和<code>database</code>。这里使用 <code>eloquent</code>驱动，<code>eloquent</code>对应使用的model类是<code>App\User:class</code>，即认证用户在user表中。</p>
<p>自定义provider，自定义类需要实现 <strong>UserProvider</strong> 接口，接口定义了如下方法需要实现:</p>
<ul>
<li>retrieveById : 获取一个代表用户的值</li>
<li>retrieveByToken : 借助用户唯一的 <strong>$identifier</strong> 和「记住我」<strong>$token</strong> 来获取用户</li>
<li>updateRememberToken : 使用新的 <strong>$token</strong> 更新 <strong>$user</strong> 的 <strong>remember_token</strong> 字段</li>
<li>retrieveByCredentials : 根据凭证数据获取一个 <strong>UserInterface</strong> 的实例。</li>
<li>validateCredentials ： 比较 $user 和 $credentials 来认证这个用户。<br>如上接口laravel也封装好了默认的实现类，分别是 <code>EloquentUserProvider</code> 和 <code>DatabaseUserProvider</code> 。当providers配置驱动(driver)为 ‘eloquent’ 时即为前者，配置驱动为 ‘database’ 时使用后者。可以查看这两个类源码看具体接口实现。</li>
</ul>
<p>自定义providers的注册与配置，自定义好providers后在AuthServiceProvider的boot方法中注册</p>
<pre><code>class AuthServiceProvider extends ServiceProvider
{
    /**
     * Register any application authentication / authorization services.
     *
     * @return void
     */
    public function boot()
    {
        $this-&gt;registerPolicies();

        Auth::provider(&#39;riak&#39;, function ($app, array $config) {
            return new RiakUserProvider($app-&gt;make(&#39;riak.connection&#39;));
        });
    }
}
</code></pre><p>而后在config/auth.php中配置</p>
<pre><code>    &#39;providers&#39; =&gt; [
        &#39;users&#39; =&gt; [
            &#39;driver&#39; =&gt; &#39;riak&#39;,
            &#39;model&#39; =&gt; App\User::class,
        ],
</code></pre><h4 id="自定义Model。"><a href="#自定义Model。" class="headerlink" title="自定义Model。"></a>自定义Model。</h4><p>自定义model需要实现接口 <strong>Illuminate\Contracts\Auth\Authenticatable</strong>  </p>
<p>系统默认实现好了一个 <strong>User</strong> model类，并使用trait  <strong>Illuminate\Auth\Authenticatable</strong> 实现接口了接口中的方法，当自定义时可以在源码实现中参考。</p>
<hr>
<h3 id="登录认证过程"><a href="#登录认证过程" class="headerlink" title="登录认证过程"></a>登录认证过程</h3><p>讲完上面的基础知识后，看一遍laravel生成的登录认证过程吧！</p>
<p>当使用命令 <code>php artisan make:auth</code>后，系统会生成了一些脚手架。首先是routes/web.php中，增加了一些路由如下:</p>
<pre><code>Auth::routes();
Route::get(&#39;/&#39;, &#39;HomeController@index&#39;)-&gt;name(&#39;home&#39;);
</code></pre><p>跟中源码可得,Auth::routes()实际上是调用Illuminate/Routing/Router类的auth方法.</p>
<pre><code class="php">    /**
     * Register the typical authentication routes for an application.
     *
     * @return void
     */
    public function auth()
    {
        // Authentication Routes...
        $this-&gt;get(&#39;login&#39;, &#39;Auth\LoginController@showLoginForm&#39;)-&gt;name(&#39;login&#39;);
        $this-&gt;post(&#39;login&#39;, &#39;Auth\LoginController@login&#39;);
        $this-&gt;post(&#39;logout&#39;, &#39;Auth\LoginController@logout&#39;)-&gt;name(&#39;logout&#39;);

        // Registration Routes...
        $this-&gt;get(&#39;register&#39;, &#39;Auth\RegisterController@showRegistrationForm&#39;)-&gt;name(&#39;register&#39;);
        $this-&gt;post(&#39;register&#39;, &#39;Auth\RegisterController@register&#39;);

        // Password Reset Routes...
        $this-&gt;get(&#39;password/reset&#39;, &#39;Auth\ForgotPasswordController@showLinkRequestForm&#39;)-&gt;name(&#39;password.request&#39;);
        $this-&gt;post(&#39;password/email&#39;, &#39;Auth\ForgotPasswordController@sendResetLinkEmail&#39;)-&gt;name(&#39;password.email&#39;);
        $this-&gt;get(&#39;password/reset/{token}&#39;, &#39;Auth\ResetPasswordController@showResetForm&#39;)-&gt;name(&#39;password.reset&#39;);
        $this-&gt;post(&#39;password/reset&#39;, &#39;Auth\ResetPasswordController@reset&#39;);
    }
</code></pre>
<p>而后进行登录操作，跳转到Auth\LoginController的showLoginForm方法。</p>
<blockquote>
<p>在LoginController中会发现没有showLoginForm方法，该类使用了<code>AuthenticatesUsers</code>这个trait实现了Auth::routes()路由中LoginController的方法。</p>
</blockquote>
<p>showLoginForm方法如下:</p>
<pre><code class="php">    /**
     * Show the application&#39;s login form.
     *
     * @return \Illuminate\Http\Response
     */
    public function showLoginForm()
    {
        return view(&#39;auth.login&#39;);
    }
</code></pre>
<p>返回默认生成的login视图，login视图的表单中有一行代码为</p>
<pre><code>&lt;form class=&quot;form-horizontal&quot; role=&quot;form&quot; method=&quot;POST&quot; action=&quot;{{ route('login') }}&quot;&gt;
</code></pre><p>即表单账号数据post到路由login中，回到web.php可以看到post到login对应的方法的为Auth\LoginController的login方法。方法源码如下。</p>
<pre><code class="php">    /**
     * Handle a login request to the application.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\RedirectResponse|\Illuminate\Http\Response
     */
    public function login(Request $request)
    {
        $this-&gt;validateLogin($request);

        // If the class is using the ThrottlesLogins trait, we can automatically throttle
        // the login attempts for this application. We&#39;ll key this by the username and
        // the IP address of the client making these requests into this application.
        if ($this-&gt;hasTooManyLoginAttempts($request)) {
            $this-&gt;fireLockoutEvent($request);

            return $this-&gt;sendLockoutResponse($request);
        }

        if ($this-&gt;attemptLogin($request)) {
            return $this-&gt;sendLoginResponse($request);
        }

        // If the login attempt was unsuccessful we will increment the number of attempts
        // to login and redirect the user back to the login form. Of course, when this
        // user surpasses their maximum number of attempts they will get locked out.
        $this-&gt;incrementLoginAttempts($request);

        return $this-&gt;sendFailedLoginResponse($request);
    }

</code></pre>
<p>首先是<code>$this-&gt;validateLogin($request);</code>,源码为：</p>
<pre><code class="php">    /**
     * Validate the user login request.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return void
     */
    protected function validateLogin(Request $request)
    {
        $this-&gt;validate($request, [
            $this-&gt;username() =&gt; &#39;required|string&#39;,
            &#39;password&#39; =&gt; &#39;required|string&#39;,
        ]);
    }
</code></pre>
<p>即验证用户的请求中用户的表单填写是否正确，这里的验证规则是 <code>$this-&gt;username</code>和<code>password</code>字段必须是非空且是string类型。<br>如果验证规则不通过，将会抛出<code>ValidationException</code>异常，也就停止了login()函数往下走了。<code>$this-&gt;username</code>字段值默认是<code>email</code>,可以在LoginController中重写username()方法，返回别的字段名如<code>user_name</code>。</p>
<p>回到login()函数，当验证规则通过后，login函数往下走，</p>
<pre><code class="php">        if ($this-&gt;hasTooManyLoginAttempts($request)) {
            $this-&gt;fireLockoutEvent($request);

            return $this-&gt;sendLockoutResponse($request);
        }
</code></pre>
<p>判断该请求是否多次登录尝试，laravel有多次登录尝试时锁定一分钟不能登录的机制，这里跳过继续往下走。</p>
<pre><code class="php">        if ($this-&gt;attemptLogin($request)) {
            return $this-&gt;sendLoginResponse($request);
        }
</code></pre>
<p>尝试登录。登录成功则发送登录成功响应。不过不成功，login函数往下走，增加这个请求的登录尝试次数，上文提到当多次请求将被锁定。最后发送登录失败响应。</p>
<p>回到attemptLogin方法，</p>
<pre><code class="php">    /**
     * Attempt to log the user into the application.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return bool
     */
    protected function attemptLogin(Request $request)
    {
        return $this-&gt;guard()-&gt;attempt(
            $this-&gt;credentials($request), $request-&gt;has(&#39;remember&#39;)
        );
    }
</code></pre>
<p>调用门卫Guard进行登录尝试。这里的<code>$this-&gt;guard()</code>方法的实现是<code>return Auth::guard();</code>,再跳转到Auth::guard()方法，</p>
<pre><code class="php">    /**
     * Attempt to get the guard from the local cache.
     *
     * @param  string  $name
     * @return \Illuminate\Contracts\Auth\Guard|\Illuminate\Contracts\Auth\StatefulGuard
     */
    public function guard($name = null)
    {
        $name = $name ?: $this-&gt;getDefaultDriver();

        return isset($this-&gt;guards[$name])
                    ? $this-&gt;guards[$name]
                    : $this-&gt;guards[$name] = $this-&gt;resolve($name);
    }
</code></pre>
<p>这里获取配置中配置使用的guard，由于不指定，所以按照config/auth.php配置后默认使用的是<code>web</code>这个guard，<code>web</code> guard配置的driver是 <code>session</code>,所以回到上文，<code>$this-&gt;guard()-&gt;attempt()</code>方法实际上调用的是 <strong>SessionGuard</strong> 类中的<code>attempt</code>方法。</p>
<pre><code class="php">    /**
     * Attempt to authenticate a user using the given credentials.
     *
     * @param  array  $credentials
     * @param  bool   $remember
     * @return bool
     */
    public function attempt(array $credentials = [], $remember = false)
    {
        $this-&gt;fireAttemptEvent($credentials, $remember);

        $this-&gt;lastAttempted = $user = $this-&gt;provider-&gt;retrieveByCredentials($credentials);

        // If an implementation of UserInterface was returned, we&#39;ll ask the provider
        // to validate the user against the given credentials, and if they are in
        // fact valid we&#39;ll log the users into the application and return true.
        if ($this-&gt;hasValidCredentials($user, $credentials)) {
            $this-&gt;login($user, $remember);

            return true;
        }

        // If the authentication attempt fails we will fire an event so that the user
        // may be notified of any suspicious attempts to access their account from
        // an unrecognized user. A developer may listen to this event as needed.
        $this-&gt;fireFailedEvent($user, $credentials);

        return false;
    }
</code></pre>
<p>第一行发送事件跳过，第二行<code>$this-&gt;lastAttempted = $user = $this-&gt;provider-&gt;retrieveByCredentials($credentials);</code>通过provider的<code>retrieveByCredentials</code>方法根据请求中携带的凭证获得Model的实例对象。这里根据在 <strong>config/auth.php</strong> 中的配置，跳转到 <strong>EloquentUserProvider</strong> 的 <code>retrieveByCredentials</code> 方法。</p>
<pre><code class="php">    /**
     * Retrieve a user by the given credentials.
     *
     * @param  array  $credentials
     * @return \Illuminate\Contracts\Auth\Authenticatable|null
     */
    public function retrieveByCredentials(array $credentials)
    {
        if (empty($credentials)) {
            return;
        }

        // First we will add each credential element to the query as a where clause.
        // Then we can execute the query and, if we found a user, return it in a
        // Eloquent User &quot;model&quot; that will be utilized by the Guard instances.
        $query = $this-&gt;createModel()-&gt;newQuery();

        foreach ($credentials as $key =&gt; $value) {
            if (! Str::contains($key, &#39;password&#39;)) {
                $query-&gt;where($key, $value);
            }
        }

        return $query-&gt;first();
    }
</code></pre>
<p>获得User这个model的查询构造器后根据凭证里面的键值对查询数据库中是否存在该对象，查询时不比对 <code>password</code> ，因为该字段在后面验证账号时才比对。</p>
<p>然后attempt方法往下走，</p>
<pre><code class="php">    public function attempt(array $credentials = [], $remember = false)
    {
        // 省略
        if ($this-&gt;hasValidCredentials($user, $credentials)) {
            $this-&gt;login($user, $remember);

            return true;
        }
        // 省略
    }

        /**
     * Determine if the user matches the credentials.
     *
     * @param  mixed  $user
     * @param  array  $credentials
     * @return bool
     */
    protected function hasValidCredentials($user, $credentials)
    {
        return ! is_null($user) &amp;&amp; $this-&gt;provider-&gt;validateCredentials($user, $credentials);
    }

</code></pre>
<p>根据凭证获得User这个模型的对象实例后，在 <code>hasValidCredentials</code> 方法判断实例是否为空，因为假设凭证数据在查询构造器中没有获得实例对象说明不存在这个数据。当 <code>$user</code> 不为空，在 <code>validateCredentials</code> 中，判断密码是否正确。</p>
<pre><code class="php">    public function validateCredentials(UserContract $user, array $credentials)
    {
        $plain = $credentials[&#39;password&#39;];

        return $this-&gt;hasher-&gt;check($plain, $user-&gt;getAuthPassword());
    }
</code></pre>
<p>在源码中可以看到默认的登录注册是将提交的密码hash加密后再与数据库中的 <code>$user</code> 对象的 <code>getAuthPassword()</code> 比较。 <code>getAuthPassword()</code> 的实现在 <code>Illuminate\Auth\Authenticatable</code> 如下。</p>
<pre><code class="php">    public function getAuthPassword()
    {
        return $this-&gt;password;
    }
</code></pre>
<p>回到attempt函数，当认证通过后，调用login函数，login函数主要做以下几件事：</p>
<pre><code class="php">    /**
     * Log a user into the application.
     *
     * @param  \Illuminate\Contracts\Auth\Authenticatable  $user
     * @param  bool  $remember
     * @return void
     */
    public function login(AuthenticatableContract $user, $remember = false)
    {
        $this-&gt;updateSession($user-&gt;getAuthIdentifier());

        // If the user should be permanently &quot;remembered&quot; by the application we will
        // queue a permanent cookie that contains the encrypted copy of the user
        // identifier. We will then decrypt this later to retrieve the users.
        if ($remember) {
            $this-&gt;ensureRememberTokenIsSet($user);

            $this-&gt;queueRecallerCookie($user);
        }

        // If we have an event dispatcher instance set we will fire an event so that
        // any listeners will hook into the authentication events and run actions
        // based on the login and logout events fired from the guard instances.
        $this-&gt;fireLoginEvent($user, $remember);

        $this-&gt;setUser($user);
    }
</code></pre>
<ul>
<li>更新session</li>
<li>如果登录时有勾选 <code>Remember me</code> 选框，<ul>
<li>生成一个token Id存储到 <code>User</code> 表中</li>
<li>生成一个<code>remember me</code>的id到cookies中，据说是永久有效</li>
</ul>
</li>
<li>发送登录事件。</li>
</ul>
<hr>
<h3 id="注册认证过程"><a href="#注册认证过程" class="headerlink" title="注册认证过程"></a>注册认证过程</h3><p>注册的处理方法为 <code>RegisterController@register</code> 方法，同理在 trait <code>RegistersUsers</code>下。</p>
<pre><code class="php">    /**
     * Handle a registration request for the application.
     *
     * @param  \Illuminate\Http\Request  $request
     * @return \Illuminate\Http\Response
     */
    public function register(Request $request)
    {
        $this-&gt;validator($request-&gt;all())-&gt;validate();

        event(new Registered($user = $this-&gt;create($request-&gt;all())));

        $this-&gt;guard()-&gt;login($user);

        return $this-&gt;registered($request, $user)
                        ?: redirect($this-&gt;redirectPath());
    }
</code></pre>
<p>注册则较为简单，第一行先根据表单填写是否符合规则，规则在  <code>RegisterController@validator</code> 下，当表单填写通过规则后，调用  <code>RegisterController@create</code> 方法在数据库中添加一行数据。而后调用 <code>SessionGuard@login</code> 方法，在上面分析过了。</p>
<hr>
<p>至此，登录注册认证过程源码追踪解析完毕！</p>

        
    

    
</div>


                

                <!-- Post Comments -->
                
                    
    <!-- 使用 Gitalk -->
<div id="gitalk-comment">
    <!-- Gitalk 评论框 -->
<div id="gitalk-container"></div>

<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">

<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<!-- <script src="https://cdn.bootcdn.net/ajax/libs/blueimp-md5/2.9.0/js/md5.min.js"></script> -->
<script src="https://unpkg.com/blueimp-md5@2.17.0/js/md5.js"></script>

<script>
    var gitalk = new Gitalk({
            clientID: '0704c11921b022bb69c6',
            clientSecret: 'fb3e959b75a60411b488927cb5ba8118d09b45c5',
            repo: 'feng409.github.io',
            owner: 'feng409',
            admin: ['feng409'],
            // facebook-like distraction free mode
            distractionFreeMode: false,
			id: md5(location.href)
        })
   gitalk.render('gitalk-container')
</script>

</div>
<style>
    #gitalk-comment {
        background-color: #eee;
        padding: 2pc;
    }
</style>

                
            </div>

            <!-- Post Prev & Next Nav -->
            <nav class="material-nav mdl-color-text--grey-50 mdl-cell mdl-cell--12-col">
    <!-- Prev Nav -->
    
        <a href="/2017/08/20/解决systemd下tmux和screen无法后台执行命令/" id="post_nav-newer" class="prev-content">
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_back</i>
            </button>
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            新篇
        </a>
    

    <!-- Section Spacer -->
    <div class="section-spacer"></div>

    <!-- Next Nav -->
    
        <a href="/2017/07/23/微信表情包电脑备份/" id="post_nav-older" class="next-content">
            旧篇
            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            <button class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon mdl-color--white mdl-color-text--grey-900" role="presentation">
                <i class="material-icons">arrow_forward</i>
            </button>
        </a>
    
</nav>

        </div>
    </div>



                    
                        <!-- Overlay For Active Sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-colored sidebar-fixed-left" role="navigation">
    <div id="sidebar-main">
        <!-- Sidebar Header -->
        <div class="sidebar-header header-cover" style="background-image: url(/img/sidebar_header.png);">
    <!-- Top bar -->
    <div class="top-bar"></div>

    <!-- Sidebar toggle button -->
    <button type="button" class="sidebar-toggle mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--icon" style="display: initial;" data-upgraded=",MaterialButton,MaterialRipple">
        <i class="material-icons">clear_all</i>
        <span class="mdl-button__ripple-container">
            <span class="mdl-ripple">
            </span>
        </span>
    </button>

    <!-- Sidebar Avatar -->
    <div class="sidebar-image">
        <img src="/img/favicon.png" alt="呃哦's avatar">
    </div>

    <!-- Sidebar Email -->
    <a data-toggle="dropdown" class="sidebar-brand" href="#settings-dropdown">
        eoyohe@email.com
        <b class="caret"></b>
    </a>
</div>


        <!-- Sidebar Navigation  -->
        <ul class="nav sidebar-nav">
    <!-- User dropdown  -->
    <li class="dropdown">
        <ul id="settings-dropdown" class="dropdown-menu">
            
                <li>
                    <a href="#" target="_blank" title="Email Me">
                        
                            <i class="material-icons sidebar-material-icons sidebar-indent-left1pc-element">email</i>
                        
                        Email Me
                    </a>
                </li>
            
        </ul>
    </li>

    <!-- Homepage -->
    
        <li id="sidebar-first-li">
            <a href="/">
                
                    <i class="material-icons sidebar-material-icons">home</i>
                
                主页
            </a>
        </li>
        
    

    <!-- Archives  -->
    
        <li class="dropdown">
            <a href="#" class="ripple-effect dropdown-toggle" data-toggle="dropdown">
                
                    <i class="material-icons sidebar-material-icons">inbox</i>
                
                    归档
                <b class="caret"></b>
            </a>
            <ul class="dropdown-menu">
            <li>
                <a class="sidebar_archives-link" href="/archives/2021/07/">七月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2021/03/">三月 2021<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/09/">九月 2020<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/08/">八月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/04/">四月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/02/">二月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2020/01/">一月 2020<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/11/">十一月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/10/">十月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2019/04/">四月 2019<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/12/">十二月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/11/">十一月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2018/05/">五月 2018<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/11/">十一月 2017<span class="sidebar_archives-count">2</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/10/">十月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/09/">九月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/08/">八月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/07/">七月 2017<span class="sidebar_archives-count">3</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/05/">五月 2017<span class="sidebar_archives-count">1</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/04/">四月 2017<span class="sidebar_archives-count">4</span></a></li><li><a class="sidebar_archives-link" href="/archives/2017/03/">三月 2017<span class="sidebar_archives-count">2</span></a>
            </ul>
        </li>
        
    

    <!-- Categories  -->
    

    <!-- Pages  -->
    
        <li>
            <a href="/links" title="友链">
                
                    <i class="material-icons sidebar-material-icons">face</i>
                
                友链
            </a>
        </li>
        
    
        <li>
            <a href="/about" title="About">
                
                    <i class="material-icons sidebar-material-icons">person</i>
                
                About
            </a>
        </li>
        
    

    <!-- Article Number  -->
    
</ul>


        <!-- Sidebar Footer -->
        <!--
I'm glad you use this theme, the development is no so easy, I hope you can keep the copyright, I will thank you so much.
If you still want to delete the copyrights, could you still retain the first one? Which namely "Theme Material"
It will not impact the appearance and can give developers a lot of support :)

很高兴您使用并喜欢该主题，开发不易 十分谢谢与希望您可以保留一下版权声明。
如果您仍然想删除的话 能否只保留第一项呢？即 "Theme Material"
它不会影响美观并可以给开发者很大的支持和动力。 :)
-->

<!-- Sidebar Divider -->

    <div class="sidebar-divider"></div>


<!-- Theme Material -->

    <a href="https://github.com/viosey/hexo-theme-material"  class="sidebar-footer-text-a" target="_blank">
        <div class="sidebar-text mdl-button mdl-js-button mdl-js-ripple-effect sidebar-footer-text-div" data-upgraded=",MaterialButton,MaterialRipple">
            主题 - Material
            <span class="sidebar-badge badge-circle">i</span>
        </div>
    </a>


<!-- Help & Support -->
<!--

-->

<!-- Feedback -->
<!--

-->

<!-- About Theme -->
<!--

-->

    </div>

    <!-- Sidebar Image -->
    

</aside>

                    

                    
                        <!-- Footer Top Button -->
                        <div id="back-to-top" class="toTop-wrap">
    <a href="#top" class="toTop">
        <i class="material-icons footer_top-i">expand_less</i>
    </a>
</div>

                    

                    <!--Footer-->
<footer class="mdl-mini-footer" id="bottom">
    
        <!-- Paradox Footer Left Section -->
        <div class="mdl-mini-footer--left-section sns-list">
    <!-- Twitter -->
    

    <!-- Facebook -->
    

    <!-- Google + -->
    

    <!-- Weibo -->
    

    <!-- Instagram -->
    

    <!-- Tumblr -->
    

    <!-- Github -->
    
        <a href="https://www.github.com/feng409" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-github">
                <span class="visuallyhidden">Github</span>
            </button><!--
     --></a>
    

    <!-- LinkedIn -->
    

    <!-- Zhihu -->
    
        <a href="https://www.zhihu.com/people/chen-feng-34-6/" target="_blank">
            <button class="mdl-mini-footer--social-btn social-btn footer-sns-zhihu">
                <span class="visuallyhidden">Zhihu</span>
            </button><!--
     --></a>
    

    <!-- Bilibili -->
    

    <!-- Telegram -->
    

    <!-- V2EX -->
    

    <!-- Segmentfault -->
    
</div>


        <!--Copyright-->
        <div id="copyright">
            Copyright&nbsp;©&nbsp;<span year></span>&nbsp;chemf
            
        </div>

        <!-- Paradox Footer Right Section -->

        <!--
        I am glad you use this theme, the development is no so easy, I hope you can keep the copyright.
        It will not impact the appearance and can give developers a lot of support :)

        很高兴您使用该主题，开发不易，希望您可以保留一下版权声明。
        它不会影响美观并可以给开发者很大的支持。 :)
        -->

        <div class="mdl-mini-footer--right-section">
            <div>
                <div class="footer-develop-div">Powered by <a href="https://hexo.io" target="_blank" class="footer-develop-a">Hexo</a></div>
                <div class="footer-develop-div">Theme - <a href="https://github.com/viosey/hexo-theme-material" target="_blank" class="footer-develop-a">Material</a></div>
            </div>
        </div>
    
</footer>


                    <!-- Import JS File -->

    <script>lsloader.load("lazyload_js","/js/lazyload.min.js?1BcfzuNXqV+ntF6gq+5X3Q==", true)</script>



    <script>lsloader.load("js_js","/js/js.min.js?Bn9UzEm8RrBSxqyZB0zPjA==", true)</script>



    <script>lsloader.load("np_js","/js/nprogress.js?pl3Qhb9lvqR1FlyLUna1Yw==", true)</script>


<script type="text/ls-javascript" id="NProgress-script">
    NProgress.configure({
        showSpinner: true
    });
    NProgress.start();
    $('#nprogress .bar').css({
        'background': '#29d'
    });
    $('#nprogress .peg').css({
        'box-shadow': '0 0 10px #29d, 0 0 15px #29d'
    });
    $('#nprogress .spinner-icon').css({
        'border-top-color': '#29d',
        'border-left-color': '#29d'
    });
    setTimeout(function() {
        NProgress.done();
        $('.fade').removeClass('out');
    }, 800);
</script>









   <!-- GitTalk -->





<!-- UC Browser Compatible -->
<script>
	var agent = navigator.userAgent.toLowerCase();
	if(agent.indexOf('ucbrowser')>0) {
		document.write('<link rel="stylesheet" href="/css/uc.css">');
	   alert('由于 UC 浏览器使用极旧的内核，而本网站使用了一些新的特性。\n为了您能更好的浏览，推荐使用 Chrome 或 Firefox 浏览器。');
	}
</script>

<!-- Import prettify js  -->


    
        <script>lsloader.load("hanabi","/js/hanabi-browser-bundle.js?Pki5+pzkluqu53g+ouMWpA==", true)</script>
    


<!-- Window Load -->
<!-- add class for prettify -->
<script type="text/ls-javascript" id="window-load">
    $(window).on('load', function() {
        // Post_Toc parent position fixed
        $('.post-toc-wrap').parent('.mdl-menu__container').css('position', 'fixed');
    });

    
    
        
        
        HanabiBrowser.start('pre code',true);
    
</script>

<!-- MathJax Load-->


<!-- Bing Background -->


<script type="text/ls-javascript" id="lazy-load">
    // Offer LazyLoad
    queue.offer(function(){
        $('.lazy').lazyload({
            effect : 'show'
        });
    });

    // Start Queue
    $(document).ready(function(){
        setInterval(function(){
            queue.execNext();
        },200);
    });
</script>

<!-- Custom Footer -->



<script>
    var copyrightNow = new Date().getFullYear();
    var textContent = document.querySelector('span[year]')

    copyrightSince = 2017;
    if (copyrightSince === copyrightNow||copyrightSince === 0000) {
        textContent.textContent = copyrightNow
    } else {
        textContent.textContent = copyrightSince + ' - ' + copyrightNow
    }

    (function(){
        var scriptList = document.querySelectorAll('script[type="text/ls-javascript"]')

        for (var i = 0; i < scriptList.length; ++i) {
            var item = scriptList[i];
            lsloader.runInlineScript(item.id,item.id);
        }
    })()
console.log('\n %c © Material Theme | Version: 1.5.6 | https://github.com/viosey/hexo-theme-material %c \n', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-left-radius:5px;border-bottom-left-radius:5px;', 'color:#455a64;background:#e0e0e0;padding:5px 0;border-top-right-radius:5px;border-bottom-right-radius:5px;');
</script>

                </main>
            </div>
        </body>
    
</html>
